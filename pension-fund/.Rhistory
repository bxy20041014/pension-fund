summary(fit1)$coefficients[, "Pr(>|t|)"][2]
for (i in 5:8) {
x=1
fit = lm(sharpe~.,data = sharpe.reg[,c(3,i)])
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
x=x+1
}
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
summary(fit1)$coefficients[, "Pr(>|t|)"][2]
for (i in 5:8) {
x=1
fit = lm(sharpe~.,data = sharpe.reg[,c(3,i)])
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
x=x+1
}
fit1 = lm(sharpe~.,data = sharpe.reg[,c(3,5)])
summary(fit1)
x=1
for (i in 5:8) {
fit = lm(sharpe~.,data = sharpe.reg[,c(3,i)])
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
x=x+1
}
nav.name
dw=dwtest(fit1)
dw[2]
dw$statistic
for (i in 5:8) {
fit = lm(sharpe~.,data = sharpe.reg[,c(3,i)])
dw=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = dw$statistic
x=x+1
}
result = data.frame(名称 = c("景顺长城成长之星股票A","建信深证基本面60ETF","工银瑞信深证100ETF",
"国联安沪深300ETF","保险主题LOF"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
result = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
result = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
x=1
for (i in 5:8) {
fit = lm(sharpe~.,data = sharpe.reg[,c(3,i)])
dw=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = dw$statistic
x=x+1
}
result = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
t
p
dw
dw=dwtest(fit1)
dw$statistic
dw$statistic[[1]]
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
x=1
for (i in 5:8) {
fit = lm(sharpe~.,data = sharpe.reg[,c(3,i)])
dw=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = dw$statistic[[1]]
x=x+1
}
dw
dw=numeric(4)
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
x=1
for (i in 5:8) {
fit = lm(sharpe~.,data = sharpe.reg[,c(3,i)])
dw=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = dw$statistic[[1]]
x=x+1
}
dw
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
x=1
for (i in 5:8) {
fit = lm(sharpe~.,data = sharpe.reg[,c(3,i)])
DW=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = DW$statistic[[1]]
x=x+1
}
dw
result = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
View(result)
rm(result)
result1 = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
x=1
for (i in 5:8) {
fit = lm(return~.,data = sharpe.reg[,c(3,i)])
DW=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = DW$statistic[[1]]
x=x+1
}
for (i in 5:8) {
fit = lm(return~.,data = sharpe.reg[,c(4,i)])
DW=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = DW$statistic[[1]]
x=x+1
}
result2 = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
View(result2)
library(readxl)
sharpe.reg.lag = read_excel("sharpe.xlsx", sheet = "2")
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
x=1
View(sharpe.reg.lag)
sharpe.reg.lag = read_excel("sharpe.xlsx", sheet = "2")
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
x=1
for (i in 5:8) {
fit = lm(sharpe~.,data = sharpe.reg.lag[,c(3,i)])
DW=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = DW$statistic[[1]]
x=x+1
}
library(lmtest)
x=1
for (i in 5:8) {
fit = lm(sharpe~.,data = sharpe.reg.lag[,c(3,i)])
DW=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = DW$statistic[[1]]
x=x+1
}
result3 = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
View(result3)
coef=numeric(4)
t=numeric(4)
p=numeric(4)
R2=numeric(4)
dw=numeric(4)
x=1
for (i in 5:8) {
fit = lm(return~.,data = sharpe.reg.lag[,c(4,i)])
DW=dwtest(fit)
coef[x] = fit$coefficients[2]
t[x] = summary(fit)$coefficients[, "t value"][2]
p[x] = summary(fit)$coefficients[, "Pr(>|t|)"][2]
R2[x] = summary(fit)$r.squared
dw[x] = DW$statistic[[1]]
x=x+1
}
result4 = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
result4 = data.frame(名称 = c("PR","RR","NAVCR","TR"),
系数 = coef,
t值 = t,
p值 = p,
R2 = R2,
DW = dw)
View(result4)
install.packages('rsconnect')
library(rsconnect)
rsconnect::setAccountInfo(name='grohdj-bo-xy',
token='AC9ED646E0BD6DBEF28CEAD98014A2FF',
secret='<SECRET>')
rsconnect::setAccountInfo(name='grohdj-bo-xy',
token='AC9ED646E0BD6DBEF28CEAD98014A2FF',
secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
library(shiny)
library(readxl)
stock <- read_excel("股指.xlsx", col_types = c("date",
"numeric", "numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
nav <- read_excel("股指.xlsx", sheet = "单位净值",
col_types = c("date", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric"))
cnav <- read_excel("股指.xlsx", sheet = "累计净值",
col_types = c("date", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric"))
library(tidyverse)
library(dplyr)
df1=tibble(cnav)
df2=tibble(nav)
df3=tibble(stock)
df=inner_join(df3,df1,by = "日期")
df=inner_join(df,df2,by = "日期")
cnav.data=df[,c(1,8,10,12,14,16,18)]
nav.data=df[,c(1,8,20,22,24,26,28)]
cnav.data=cnav.data[-729,]
nav.data=nav.data[-729,]
name=c("日期","混合基准收益率","建信深证基本面60ETF","工银瑞信深证100ETF","国联安沪深300ETF","景顺长城成长之星股票A","保险主题LOF")
colnames(cnav.data)=name
colnames(nav.data)=name
cnav.name=names(cnav.data[,-1]);cnav.name
nav.name=names(nav.data[,-1]);nav.name
#shinny----
library(shiny)
library(plotly)
#定义UI----
ui <- fluidPage(
titlePanel("基金收益率随时间变化图"),
# 选择数据框输入
sidebarLayout(
sidebarPanel(
selectInput(inputId = "dataset", label = "选择指标:",
choices = list("累计净值" = "累计净值", "日净值" = "日净值")),
# 选择基金收益率列
checkboxGroupInput(inputId = "funds", label = "选择基金名称:",
choices = cnav.name,
selected = cnav.name)
),
# 主页面显示ggplot图表
mainPanel(
plotlyOutput("fundPlot")
)
)
)
# 服务器部分----
server <- function(input, output) {
# 动态选择数据框
selectedData <- reactive({
if (input$dataset == "累计净值") {
return(cnav.data)
} else {
return(nav.data)
}
})
# 检查selectedData是否正确加载
observe({
print(head(selectedData()))
})
# 检查input$funds是否有效
observe({
print(input$funds)
})
# 绘制图形
output$fundPlot <- renderPlotly({
# 获取选择的数据
data <- selectedData()
data |>
pivot_longer(cols = input$funds,
names_to = "基金", values_to = "净值增长率") |>
ggplot(aes(x = 日期, y = 净值增长率, color = 基金)) +
geom_line(size=0.1) +
theme_minimal() +
theme(legend.position = "bottom")
})
}
#调用----
shinyApp(ui = ui, server = server)
rsconnect::setAccountInfo(name='grohdj-bo-xy', token='AC9ED646E0BD6DBEF28CEAD98014A2FF', secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
rsconnect::deployApp(C://Users//博学一//Desktop//退休基金)
rsconnect::deployApp(C:/Users/博学一/Desktop/退休基金)
rsconnect::deployApp(C:\\Users\\博学一\\Desktop\\退休基金)
rsconnect::deployApp("C:/Users/博学一/Desktop/退休基金")
rsconnect::setAccountInfo(name='grohdj-bo-xy', token='AC9ED646E0BD6DBEF28CEAD98014A2FF', secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
rsconnect::deployApp("C:/Users/博学一/Desktop/退休基金")
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/退休基金",
appName = "retirement_fund_app",  # 选择一个有效且描述性的名称
account = "grohdj-bo-xy"     # 可选：指定您的账户名称
)
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/退休基金",
appName = "retirement_fund_app",  # 选择一个有效且描述性的名称
account = "grohdj-bo-xy"     # 可选：指定您的账户名称
)
library(readxl)
stock <- read_excel("股指.xlsx", col_types = c("date",
"numeric", "numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
nav <- read_excel("股指.xlsx", sheet = "单位净值",
col_types = c("date", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric"))
cnav <- read_excel("股指.xlsx", sheet = "累计净值",
col_types = c("date", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric"))
library(tidyverse)
library(dplyr)
df1=tibble(cnav)
df2=tibble(nav)
df3=tibble(stock)
df=inner_join(df3,df1,by = "日期")
df=inner_join(df,df2,by = "日期")
cnav.data=df[,c(1,8,10,12,14,16,18)]
nav.data=df[,c(1,8,20,22,24,26,28)]
cnav.data=cnav.data[-729,]
nav.data=nav.data[-729,]
name=c("日期","混合基准收益率","建信深证基本面60ETF","工银瑞信深证100ETF","国联安沪深300ETF","景顺长城成长之星股票A","保险主题LOF")
colnames(cnav.data)=name
colnames(nav.data)=name
cnav.name=names(cnav.data[,-1]);cnav.name
nav.name=names(nav.data[,-1]);nav.name
rsconnect::setAccountInfo(name='grohdj-bo-xy', token='AC9ED646E0BD6DBEF28CEAD98014A2FF', secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/退休基金/app",
appName = "retirement_fund_app",  # 选择一个有效且描述性的名称
account = "grohdj-bo-xy"     # 可选：指定您的账户名称
)
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/退休基金/app",
appName = "retirement_fund_app",  # 选择一个有效且描述性的名称
account = "grohdj-bo-xy"     # 可选：指定您的账户名称
)
#shinny----
library(shiny)
library(plotly)
#定义UI----
ui <- fluidPage(
titlePanel("基金收益率随时间变化图"),
# 选择数据框输入
sidebarLayout(
sidebarPanel(
selectInput(inputId = "dataset", label = "选择指标:",
choices = list("累计净值" = "累计净值", "日净值" = "日净值")),
# 选择基金收益率列
checkboxGroupInput(inputId = "funds", label = "选择基金名称:",
choices = cnav.name,
selected = cnav.name)
),
# 主页面显示ggplot图表
mainPanel(
plotlyOutput("fundPlot")
)
)
)
# 服务器部分----
server <- function(input, output) {
# 动态选择数据框
selectedData <- reactive({
if (input$dataset == "累计净值") {
return(cnav.data)
} else {
return(nav.data)
}
})
# 检查selectedData是否正确加载
observe({
print(head(selectedData()))
})
# 检查input$funds是否有效
observe({
print(input$funds)
})
# 绘制图形
output$fundPlot <- renderPlotly({
# 获取选择的数据
data <- selectedData()
data |>
pivot_longer(cols = input$funds,
names_to = "基金", values_to = "净值增长率") |>
ggplot(aes(x = 日期, y = 净值增长率, color = 基金)) +
geom_line(size=0.1) +
theme_minimal() +
theme(legend.position = "bottom")
})
}
#调用----
shinyApp(ui = ui, server = server)
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/app",
appName = "retirement_fund_app",  # 选择一个有效且描述性的名称
account = "grohdj-bo-xy"     # 可选：指定您的账户名称
)
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/app",
appName = "retirement_fund_app",  # 选择一个有效且描述性的名称
account = "grohdj-bo-xy"     # 可选：指定您的账户名称
)
rsconnect::setAccountInfo(name='grohdj-bo-xy', token='AC9ED646E0BD6DBEF28CEAD98014A2FF', secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/app",
appName = "retirement_fund_app",  # 选择一个有效且描述性的名称
account = "grohdj-bo-xy"     # 可选：指定您的账户名称
)
rsconnect::setAccountInfo(name='grohdj-bo-xy', token='AC9ED646E0BD6DBEF28CEAD98014A2FF', secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
rsconnect::setAccountInfo(name='grohdj-bo-xy', token='AC9ED646E0BD6DBEF28CEAD98014A2FF', secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
> rsconnect::deployApp(
rsconnect::setAccountInfo(name='grohdj-bo-xy', token='AC9ED646E0BD6DBEF28CEAD98014A2FF', secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
rsconnect::deployApp(
+   appDir = "C:/Users/博学一/Desktop/app",
rsconnect::deployApp(
+   appDir = "C:/Users/博学一/Desktop/app",
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/app",
appName = "retirement_fund_app",  # 选择一个有效且描述性的名称
account = "grohdj-bo-xy"     # 可选：指定您的账户名称
)
rsconnect::setAccountInfo(name='grohdj-bo-xy', token='AC9ED646E0BD6DBEF28CEAD98014A2FF', secret='lk/EemzHjtBuHk5FpUFSDi+jhvzLOrPfZO/djlr6')
rsconnect::deployApp(
appDir = "C:/Users/博学一/Desktop/app",
appName = "retirement_fund_app",
account = "grohdj-bo-xy"
)
